<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>arcsdec::v_1_0_0::BlockAccumulator class | libarcsdec Audio decoder and TOC parser adapters for libarcstk</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://codeberg.org/tristero/libarcsdec/">libarcsdec</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">Audio decoder and TOC parser adapters for libarcstk</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="modules.html">Modules</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="2">
            <li><a href="namespaces.html">Namespaces</a></li>
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="namespacearcsdec.html">arcsdec</a>::<wbr/></span>v_1_0_0::BlockAccumulator <span class="m-thin">class</span>
          <div class="m-doc-include m-code m-inverted m-text-right"><span class="cp">#include</span> <a class="cpf" href="audiobuffer_8hpp.html">&lt;audiobuffer.hpp&gt;</a></div>
        </h1>
        <p>Basic buffer: specify size, fill with samples and then flush.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#base-classes">Base classes</a></li>
                <li><a href="#typeless-methods">Constructors, destructors, conversion operators</a></li>
                <li><a href="#pub-methods">Public functions</a></li>
                <li><a href="#pro-methods">Protected functions</a></li>
                <li><a href="#pri-methods">Private functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
<p>Accumulates SampleSequences to the configured block size and passes the block to a consumer as soon as it is filled completely.</p><p>In come sequences of non-zero size smaller than the block, out go blocks of the defined size.</p><p>Not every decoder is compatible to pull-reading a specified block size. If it is required or advantageous to read the samples in smaller sequences, the sequences have to be accumulated to a block. To make a decoder compatible with this strategy, define an appropriate subclass of SampleSequence.</p>
        <section id="base-classes">
          <h2><a href="#base-classes">Base classes</a></h2>
          <dl class="m-doc">
            <dt>
              class <a href="classarcsdec_1_1v__1__0__0_1_1BlockCreator.html" class="m-doc">v_1_0_0::BlockCreator</a> <span class="m-label m-flat m-warning">virtual</span>
            </dt>
            <dd>Base class of a sample block creator.</dd>
          </dl>
        </section>
        <section id="typeless-methods">
          <h2><a href="#typeless-methods">Constructors, destructors, conversion operators</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#a9615df0d40679c69150f45668f1fb3a4" class="m-doc">BlockAccumulator</a>(</span><span class="m-doc-wrap">)</span>
            </dt>
            <dd>Default constructor.</dd>
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#a0fc5e6cd154d79667846dfa6ef88fcbd" class="m-doc">BlockAccumulator</a>(</span><span class="m-doc-wrap">const int32_t samples_per_block) <span class="m-label m-flat m-info">explicit</span> </span>
            </dt>
            <dd>Constructs a <a href="classarcsdec_1_1v__1__0__0_1_1BlockAccumulator.html" class="m-doc">BlockAccumulator</a> with buffer of size samples_per_block.</dd>
            <dt id="a1d6018765476b352570021fe0b74e195">
              <span class="m-doc-wrap-bumper"><a href="#a1d6018765476b352570021fe0b74e195" class="m-doc-self">~BlockAccumulator</a>(</span><span class="m-doc-wrap">) <span class="m-label m-flat m-warning">override</span> <span class="m-label m-flat m-success">noexcept</span></span>
            </dt>
            <dd>Virtual default destructor.</dd>
          </dl>
        </section>
        <section id="pub-methods">
          <h2><a href="#pub-methods">Public functions</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#aad9f60e2d85401535ebe749ce0c29afb" class="m-doc">append_to_block</a>(</span><span class="m-doc-wrap">SampleInputIterator begin,
              SampleInputIterator end)</span>
            </dt>
            <dd>Appends a sample sequence to the buffer.</dd>
            <dt id="a995feeda1ca22ad25c0a48f06af0c61e">
              <span class="m-doc-wrap-bumper">void <a href="#a995feeda1ca22ad25c0a48f06af0c61e" class="m-doc-self">flush</a>(</span><span class="m-doc-wrap">)</span>
            </dt>
            <dd>Call this method after having passed the last sample sequence.</dd>
            <dt id="a61ab54699767290f173a082d0ea3d2a3">
              <span class="m-doc-wrap-bumper">void <a href="#a61ab54699767290f173a082d0ea3d2a3" class="m-doc-self">init</a>(</span><span class="m-doc-wrap">)</span>
            </dt>
            <dd>Call this method before passing the first sample sequence.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#ab87f14efee00bceacb2ff9d043cb051b" class="m-doc">register_block_consumer</a>(</span><span class="m-doc-wrap">const std::function&lt;void(SampleInputIterator begin, SampleInputIterator end)&gt;&amp; func)</span>
            </dt>
            <dd>Registers a consuming method for sample sequences.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#af13066e9db2b934b10897de02256a32a" class="m-doc">samples_appended</a>(</span><span class="m-doc-wrap">) const -&gt; int32_t</span>
            </dt>
            <dd>Returns the number of samples processed.</dd>
          </dl>
        </section>
        <section id="pro-methods">
          <h2><a href="#pro-methods">Protected functions</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#a429c9b065b1232d1d928591fe8730a39" class="m-doc">init_buffer</a>(</span><span class="m-doc-wrap">const int32_t total_samples)</span>
            </dt>
            <dd>Reinitialize internal buffer to specified size as number of 32 bit PCM samples.</dd>
          </dl>
        </section>
        <section id="pri-methods">
          <h2><a href="#pri-methods">Private functions</a></h2>
          <dl class="m-doc">
            <dt id="a6cdce6f18599506e6d8b0d22a54890e4">
              <span class="m-doc-wrap-bumper">void <a href="#a6cdce6f18599506e6d8b0d22a54890e4" class="m-doc-self">do_flush</a>(</span><span class="m-doc-wrap">) <span class="m-label m-flat m-warning">virtual</span></span>
            </dt>
            <dd>Implementation of <a href="classarcsdec_1_1v__1__0__0_1_1BlockAccumulator.html#a995feeda1ca22ad25c0a48f06af0c61e" class="m-doc">flush()</a></dd>
            <dt id="a2ffe556042ca2c521dced4a7459e105b">
              <span class="m-doc-wrap-bumper">void <a href="#a2ffe556042ca2c521dced4a7459e105b" class="m-doc-self">do_init</a>(</span><span class="m-doc-wrap">) <span class="m-label m-flat m-warning">virtual</span></span>
            </dt>
            <dd>Implementation of <a href="classarcsdec_1_1v__1__0__0_1_1BlockAccumulator.html#a61ab54699767290f173a082d0ea3d2a3" class="m-doc">init()</a></dd>
            <dt id="a2a453c90d61d49e08c803864fbdca8fc">
              <span class="m-doc-wrap-bumper">void <a href="#a2a453c90d61d49e08c803864fbdca8fc" class="m-doc-self">init_buffer</a>(</span><span class="m-doc-wrap">) <span class="m-label m-flat m-warning">virtual</span></span>
            </dt>
            <dd>Reinitialize internal buffer to configured block size.</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="a9615df0d40679c69150f45668f1fb3a4"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> arcsdec::<wbr />v_1_0_0::<wbr />BlockAccumulator::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a9615df0d40679c69150f45668f1fb3a4" class="m-doc-self">BlockAccumulator</a>(</span><span class="m-doc-wrap">)</span></span>
            </h3>
            <p>Default constructor.</p>
<p>Constructs a <a href="classarcsdec_1_1v__1__0__0_1_1BlockAccumulator.html" class="m-doc">BlockAccumulator</a> with buffer of size BLOCKSIZE::DEFAULT</p>
          </div></section>
          <section class="m-doc-details" id="a0fc5e6cd154d79667846dfa6ef88fcbd"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> arcsdec::<wbr />v_1_0_0::<wbr />BlockAccumulator::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a0fc5e6cd154d79667846dfa6ef88fcbd" class="m-doc-self">BlockAccumulator</a>(</span><span class="m-doc-wrap">const int32_t samples_per_block) <span class="m-label m-info">explicit</span> </span></span>
            </h3>
            <p>Constructs a <a href="classarcsdec_1_1v__1__0__0_1_1BlockAccumulator.html" class="m-doc">BlockAccumulator</a> with buffer of size samples_per_block.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">samples_per_block&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Number of 32 bit PCM samples in one block</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="aad9f60e2d85401535ebe749ce0c29afb"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void arcsdec::<wbr />v_1_0_0::<wbr />BlockAccumulator::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#aad9f60e2d85401535ebe749ce0c29afb" class="m-doc-self">append_to_block</a>(</span><span class="m-doc-wrap">SampleInputIterator begin,
              SampleInputIterator end)</span></span>
            </h3>
            <p>Appends a sample sequence to the buffer.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">begin&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Begin of the sample sequence</td>
                </tr>
                <tr>
                  <td>end&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>End of the sample sequence</td>
                </tr>
              </tbody>
            </table>
<p>It is guaranteed that the entire sequence is appended. However, if the sequence is longer than the remaining buffer capacity, the buffer is immediately flushed when full, so appending may cause flushing. Hence it is not guaranteed, that the entire sequence is part of the same block.</p>
          </div></section>
          <section class="m-doc-details" id="ab87f14efee00bceacb2ff9d043cb051b"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void arcsdec::<wbr />v_1_0_0::<wbr />BlockAccumulator::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#ab87f14efee00bceacb2ff9d043cb051b" class="m-doc-self">register_block_consumer</a>(</span><span class="m-doc-wrap">const std::function&lt;void(SampleInputIterator begin, SampleInputIterator end)&gt;&amp; func)</span></span>
            </h3>
            <p>Registers a consuming method for sample sequences.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">func&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>The functor to be registered as sample consumer.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="af13066e9db2b934b10897de02256a32a"><div>
            <h3>
              <span class="m-doc-wrap-bumper">int32_t arcsdec::<wbr />v_1_0_0::<wbr />BlockAccumulator::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#af13066e9db2b934b10897de02256a32a" class="m-doc-self">samples_appended</a>(</span><span class="m-doc-wrap">) const</span></span>
            </h3>
            <p>Returns the number of samples processed.</p>
            <table class="m-table m-fullwidth m-flat">
              <tfoot>
                <tr>
                  <th style="width: 1%">Returns</th>
                  <td>Number of samples processed since <a href="classarcsdec_1_1v__1__0__0_1_1BlockAccumulator.html#a61ab54699767290f173a082d0ea3d2a3" class="m-doc">init()</a> was called</td>
                </tr>
              </tfoot>
            </table>
          </div></section>
          <section class="m-doc-details" id="a429c9b065b1232d1d928591fe8730a39"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void arcsdec::<wbr />v_1_0_0::<wbr />BlockAccumulator::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a429c9b065b1232d1d928591fe8730a39" class="m-doc-self">init_buffer</a>(</span><span class="m-doc-wrap">const int32_t total_samples) <span class="m-label m-warning">protected</span></span></span>
            </h3>
            <p>Reinitialize internal buffer to specified size as number of 32 bit PCM samples.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">total_samples&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Reinitialize buffer for new block</td>
                </tr>
              </tbody>
            </table>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>libarcsdec Audio decoder and TOC parser adapters for libarcstk. Created with <a href="https://doxygen.org/">Doxygen</a> 1.8.20 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
